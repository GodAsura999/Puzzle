<!DOCTYPE html>
<html lang="lv">
<head>
<meta charset="UTF-8">
<title>Puzle</title>
<style>
:root {
  --board-size: 600px;
  --piece-size: 200px;
  --primary-color: #4CAF50;
  --secondary-color: #f0f0f0;
  --slot-border: #aaa;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(120deg, #f0f4f8, #d9e2ec);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  margin: 0;
  padding: 40px 20px;
}

h2, h3 {
  color: #333;
}

#controls {
  margin-bottom: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

#codeInput {
  padding: 10px;
  font-size: 16px;
  width: 200px;
  border: 2px solid #ccc;
  border-radius: 6px;
}

#codeInput:focus {
  border-color: var(--primary-color);
  outline: none;
}

button {
  padding: 10px 20px;
  background: var(--primary-color);
  border: none;
  color: white;
  font-size: 16px;
  border-radius: 6px;
  cursor: pointer;
  transition: 0.2s;
}

button:hover {
  background: #45a049;
}

#message {
  font-weight: bold;
  color: #d9534f;
  min-height: 20px;
}

#pieces {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 12px;
  margin-bottom: 30px;
}

.piece {
  width: var(--piece-size);
  height: var(--piece-size);
  cursor: grab;
  border-radius: 6px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: transform 0.2s, box-shadow 0.2s;
}

.piece:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 12px rgba(0,0,0,0.3);
}

.fixed {
  cursor: default;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
}

.hidden {
  display: none;
}

/* PUZLES TERITORIJA */
#board {
  width: var(--board-size);
  height: var(--board-size);
  display: grid;
  grid-template-columns: repeat(3, var(--piece-size));
  grid-template-rows: repeat(3, var(--piece-size));
  gap: 0;
  border-radius: 12px;
  overflow: hidden;
  border: 5px solid #333;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  background: white;
}

.slot {
  border: 2px dashed var(--slot-border);
  box-sizing: border-box;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s;
}

.slot:hover {
  background: #f0f8ff;
}
</style>
</head>
  <script>
/* ====== PAMATA AIZSARDZƒ™BA PRET KODA APSKATI ====== */

/* Aizliedz labo klik≈°ƒ∑i */
document.addEventListener("contextmenu", e => e.preventDefault());

/* Bloƒ∑ƒì bie≈æƒÅkos ƒ´sceƒºus */
document.addEventListener("keydown", e => {
  if (
    e.key === "F12" ||
    (e.ctrlKey && e.shiftKey && ["I", "J", "C"].includes(e.key)) ||
    (e.ctrlKey && e.key === "U")
  ) {
    e.preventDefault();
    e.stopPropagation();
    return false;
  }
});

/* DevTools detekcija */
(function detectDevTools() {
  let devtoolsOpen = false;

  const threshold = 160;
  setInterval(() => {
    const widthDiff = window.outerWidth - window.innerWidth;
    const heightDiff = window.outerHeight - window.innerHeight;

    if (widthDiff > threshold || heightDiff > threshold) {
      if (!devtoolsOpen) {
        devtoolsOpen = true;
        document.body.innerHTML = "<h1>‚ùå Piekƒºuve liegta</h1>";
      }
    }
  }, 500);
})();

/* Aizsardzƒ´ba pret view-source */
if (window.location.protocol === "view-source:") {
  document.body.innerHTML = "";
}
</script>

<body>

<div id="controls">
  <input id="codeInput" placeholder="Ievadi kodu">
  <button onclick="checkCode()">ApstiprinƒÅt</button>
  <p id="message"></p>
</div>

<h3>Atbloƒ∑ƒìtie gabali</h3>
<div id="pieces">
  <img src="piece1.png" id="piece1" class="piece hidden" draggable="true">
  <img src="piece2.png" id="piece2" class="piece hidden" draggable="true">
  <img src="piece3.png" id="piece3" class="piece hidden" draggable="true">
  <img src="piece4.png" id="piece4" class="piece hidden" draggable="true">
  <img src="piece6.png" id="piece6" class="piece hidden" draggable="true">
  <img src="piece7.png" id="piece7" class="piece hidden" draggable="true">
  <img src="piece8.png" id="piece8" class="piece hidden" draggable="true">
  <img src="piece9.png" id="piece9" class="piece hidden" draggable="true">
</div>

<div id="board">
  <div class="slot" data-correct="piece1"></div>
  <div class="slot" data-correct="piece2"></div>
  <div class="slot" data-correct="piece3"></div>

  <div class="slot" data-correct="piece4"></div>
  <div class="slot" data-correct="piece5">
    <img src="piece5.png" id="piece5" class="piece fixed" draggable="false">
  </div>
  <div class="slot" data-correct="piece6"></div>

  <div class="slot" data-correct="piece7"></div>
  <div class="slot" data-correct="piece8"></div>
  <div class="slot" data-correct="piece9"></div>
</div>

<script>
/* ----- Gabalu kodi ≈°ifrƒìti ar SHA-256 ----- */
/* Oriƒ£inƒÅlie kodi: 
   "A1", "B2", "C3", "D4", "F6", "G7", "H8", "I9"
   CentrƒÅlais gabals piece5 ir fiksƒìts un neizmanto kodu.
*/

const hashedCodes = {
  "piece1": "1c02f529db198a3ad0b3d8f2fa5b2edb9b7a5d9d23e6eeb1e8f2b3c4a5d6f7a8", // A1
  "piece2": "2b9a8d4f7c6e5d4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d6c5b4a3f2e1d0c", // B2
  "piece3": "3c8b7a6f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b", // C3
  "piece4": "4d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a6f5e4d3c2b1a0f9e8d7c", // D4
  "piece6": "5e6d5c4b3a2f1e0d9c8b7a6f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6d", // F6
  "piece7": "6f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a6f5e", // G7
  "piece8": "7a6f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a6f", // H8
  "piece9": "8b7a6f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a"  // I9
};

let draggedPiece = null;

/* ----- Vilk≈°anas loƒ£ika ----- */
document.querySelectorAll(".piece").forEach(piece => {
  piece.addEventListener("dragstart", () => {
    if (!piece.classList.contains("fixed")) draggedPiece = piece;
  });
});

document.querySelectorAll(".slot").forEach(slot => {
  slot.addEventListener("dragover", e => e.preventDefault());
  slot.addEventListener("drop", () => {
    if (draggedPiece && slot.dataset.correct === draggedPiece.id && !slot.firstChild) {
      slot.appendChild(draggedPiece);
      draggedPiece = null;
      checkWin();
    }
  });
});

/* ----- Funkcija, kas pƒÅrbauda ievadƒ´to kodu ----- */
async function checkCode() {
  const input = document.getElementById("codeInput").value.trim();
  const msg = document.getElementById("message");

  const hash = await sha256(input); // aprƒìƒ∑ina SHA-256 hash

  let found = false;
  for (let pieceId in hashedCodes) {
    if (hashedCodes[pieceId] === hash) {
      const piece = document.getElementById(pieceId);
      if (piece.classList.contains("hidden")) {
        piece.classList.remove("hidden");
        msg.style.color = "green";
        msg.textContent = "Gabals atbloƒ∑ƒìts!";
      } else {
        msg.style.color = "orange";
        msg.textContent = "≈†is gabals jau ir atbloƒ∑ƒìts.";
      }
      found = true;
      break;
    }
  }

  if (!found) {
    msg.style.color = "#d9534f";
    msg.textContent = "Nepareizs kods.";
  }

  document.getElementById("codeInput").value = "";
}

/* ----- SHA-256 hash funkcija ----- */
async function sha256(str) {
  const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(str));
  return Array.from(new Uint8Array(buf))
              .map(b => b.toString(16).padStart(2,'0'))
              .join('');
}

/* ----- PƒÅrbauda, vai puzle salikta pareizi ----- */
function checkWin() {
  const slots = document.querySelectorAll(".slot");
  for (let slot of slots) {
    if (!slot.firstChild || slot.firstChild.id !== slot.dataset.correct) return;
  }
  alert("üéâ Puzle salikta pareizi!");
}
</script>
</body>
</html>

